name: Deploy React App to GitHub Pages

on:
  push:
    branches:
      - main  # Change to your default branch name

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Checkout the code
      - name: Checkout code
        uses: actions/checkout@v2

      # Step 2: Set up Docker (optional if Dockerfile is used)
      - name: Set up Docker
        uses: docker/setup-buildx-action@v1

      # Step 3: Build the Docker image for the React app
      - name: Build Docker image
        run: |
          docker build -t web-gen-app -f web-gen-app/Dockerfile .

      # Step 4: Create a container from the Docker image and copy the 'build' directory
      - name: Run container and copy build
        run: |
          docker create --name web-gen-container web-gen-app
          docker cp web-gen-container:/app/build ./build
          docker rm web-gen-container

      # Step 5: Deploy the build to GitHub Pages
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build

